<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="logo.png" type="image/png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>
    <script src="element-table.js" type="module"></script>
    <script src="element-grid.js" type="module"></script>
    <script src="element-contextmenu.js" type="module"></script>
    <script src="widget-text.js" type="module"></script>
    <script src="widget-text-centered.js" type="module"></script>
    <script src="widget-code.js" type="module"></script>
    <script src="widget-image.js" type="module"></script>
    <script src="widget-download.js" type="module"></script>
    <script src="widget-hashimg.js" type="module"></script>
    <script src="widget-sheetkey.js" type="module"></script>
    <script src="widget-taskid.js" type="module"></script>
    <script src="widget-taskname.js" type="module"></script>
    <script src="widget-taskstatus.js" type="module"></script>
    <script src="widget-tasktype.js" type="module"></script>
    <script src="widget-timestamp.js" type="module"></script>
    <script src="widget-relative-timestamp.js" type="module"></script>
    <script src="widget-jsonschema.js" type="module"></script>
    <script src="widget-jsonschema-validation.js" type="module"></script>
    <script src="widget-jsonschema-explanation.js" type="module"></script>
    <script src="widget-multi.js" type="module"></script>
    <script src="widget-testresult.js" type="module"></script>
    <script src="widget-transitions.js" type="module"></script>
    <script src="widget-schedule-task.js" type="module"></script>
    <script src="widget-json-viewer.js" type="module"></script>
    <script src="widget-progress.js" type="module"></script>
    <script src="widget-duration.js" type="module"></script>
    <script src="widget-rating.js" type="module"></script>
    <script src="widget-metric.js" type="module"></script>
    <script src="widget-video.js" type="module"></script>
    <script src="widget-audio.js" type="module"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.js"></script>
    <script src="widget-qr-code.js" type="module"></script>
    <script src="header.js"></script>
</head>

<body>
    <div id="header-placeholder"></div>
    <div style="padding: 20px;">
        <h2>Help</h2>
        <h3>Running Agents</h3>
        <p>To run a Deno agent, use the following command:</p>
        <pre><code id="deno-prod" class="language-bash">deno run --reload -A ${SHEETBOT_BASEURL}/scripts/agent.ts</code></pre>
        <p>To run a Python agent with uv, use the following command:</p>
        <pre><code id="python-prod" class="language-bash">uv run --script ${SHEETBOT_BASEURL}/scripts/agent.py</code></pre>
        <p>To run a Bash agent, use the following command:</p>
        <pre><code id="bash-prod" class="language-bash">curl -fsSL ${SHEETBOT_BASEURL}/scripts/agent.sh | bash</code></pre>
        <p>For authentication, set SHEETBOT_AUTH_USER and SHEETBOT_AUTH_PASS if needed.</p>
        <h3>Example Script</h3>
        <p>You can create a bash script to run the agent with authentication:</p>
        <pre><code id="example-script" class="language-bash">#!/bin/bash
export SHEETBOT_AUTH_USER=username
export SHEETBOT_AUTH_PASS=password
export SHEETBOT_BASEURL={{BASE_URL}}

deno run --reload -A ${SHEETBOT_BASEURL}/scripts/agent.ts</code></pre>

        <h3>Widget Gallery</h3>
        <p>Below is a comprehensive gallery of all available widgets in SheetBot:</p>

        <!-- Widget Scripts -->
        <script src="element-table.js" type="module"></script>
        <script src="element-grid.js" type="module"></script>
        <script src="element-contextmenu.js" type="module"></script>
        <script src="widget-text.js" type="module"></script>
        <script src="widget-text-centered.js" type="module"></script>
        <script src="widget-code.js" type="module"></script>
        <script src="widget-image.js" type="module"></script>
        <script src="widget-download.js" type="module"></script>
        <script src="widget-hashimg.js" type="module"></script>
        <script src="widget-sheetkey.js" type="module"></script>
        <script src="widget-taskid.js" type="module"></script>
        <script src="widget-taskname.js" type="module"></script>
        <script src="widget-taskstatus.js" type="module"></script>
        <script src="widget-tasktype.js" type="module"></script>
        <script src="widget-timestamp.js" type="module"></script>
        <script src="widget-relative-timestamp.js" type="module"></script>
        <script src="widget-jsonschema.js" type="module"></script>
        <script src="widget-jsonschema-validation.js" type="module"></script>
        <script src="widget-jsonschema-explanation.js" type="module"></script>
        <script src="widget-multi.js" type="module"></script>
        <script src="widget-testresult.js" type="module"></script>
        <script src="widget-transitions.js" type="module"></script>
        <script src="widget-schedule-task.js" type="module"></script>
        <script src="widget-json-viewer.js" type="module"></script>
        <script src="widget-progress.js" type="module"></script>
        <script src="widget-duration.js" type="module"></script>
        <script src="widget-rating.js" type="module"></script>
    <script src="widget-metric.js" type="module"></script>
    <script src="widget-video.js" type="module"></script>
    <script src="widget-audio.js" type="module"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.js"></script>
    <script src="widget-qr-code.js" type="module"></script>

        <!-- Text Widgets -->
        <h4>Text Widgets</h4>
        <p>Basic text display and formatting widgets</p>
        <div class="table-wrapper"><element-grid id="text-widgets"></element-grid></div>
        <details style="margin-top: 10px;">
            <summary>Source Data</summary>
            <pre><code id="text-data" class="language-json"></code></pre>
        </details>

        <!-- Code & Data Widgets -->
        <h4>Code & Data Widgets</h4>
        <p>Widgets for displaying code, JSON data, and structured information</p>
        <div class="table-wrapper"><element-grid id="code-widgets"></element-grid></div>
        <details style="margin-top: 10px;">
            <summary>Source Data</summary>
            <pre><code id="code-data" class="language-json"></code></pre>
        </details>

        <!-- Media & File Widgets -->
        <h4>Media & File Widgets</h4>
        <p>Widgets for images, downloads, and file-related content</p>
        <div class="table-wrapper"><element-grid id="media-widgets"></element-grid></div>
        <details style="margin-top: 10px;">
            <summary>Source Data</summary>
            <pre><code id="media-data" class="language-json"></code></pre>
        </details>

        <!-- Task & Status Widgets -->
        <h4>Task & Status Widgets</h4>
        <p>Widgets for displaying task information and status indicators</p>
        <div class="table-wrapper"><element-grid id="task-widgets"></element-grid></div>
        <details style="margin-top: 10px;">
            <summary>Source Data</summary>
            <pre><code id="task-data" class="language-json"></code></pre>
        </details>

        <h4>Time & Progress Widgets</h4>
        <p>Widgets for time display, progress tracking, and duration formatting</p>
        <div class="table-wrapper"><element-grid id="time-widgets"></element-grid></div>
        <details style="margin-top: 10px;">
            <summary>Source Data</summary>
            <pre><code id="time-data" class="language-json"></code></pre>
        </details>

        <!-- Rating & Quality Widgets -->
        <h4>Rating & Quality Widgets</h4>
        <p>Widgets for ratings, test results, and quality indicators</p>
        <div class="table-wrapper"><element-grid id="rating-widgets"></element-grid></div>
        <details style="margin-top: 10px;">
            <summary>Source Data</summary>
            <pre><code id="rating-data" class="language-json"></code></pre>
        </details>

        <!-- Schema & Validation Widgets -->
        <h4>Schema & Validation Widgets</h4>
        <p>Widgets for JSON Schema display, validation, and explanation</p>
        <div class="table-wrapper"><element-grid id="schema-widgets"></element-grid></div>
        <details style="margin-top: 10px;">
            <summary>Source Data</summary>
            <pre><code id="schema-data" class="language-json"></code></pre>
        </details>

        <!-- Interactive & Utility Widgets -->
        <h4>Interactive & Utility Widgets</h4>
        <p>Interactive buttons, multi-widgets, utility components, and QR codes</p>
        <div class="table-wrapper"><element-grid id="interactive-widgets"></element-grid></div>
        <details style="margin-top: 10px;">
            <summary>Source Data</summary>
            <pre><code id="interactive-data" class="language-json"></code></pre>
        </details>
    </div>
</body>

<script>
        const baseUrl = window.location.origin;
        document.getElementById('example-script').textContent = document.getElementById('example-script').textContent.replace('{{BASE_URL}}', baseUrl);
        document.getElementById('deno-prod').textContent = document.getElementById('deno-prod').textContent.replace('${SHEETBOT_BASEURL}', baseUrl);
        document.getElementById('python-prod').textContent = document.getElementById('python-prod').textContent.replace('${SHEETBOT_BASEURL}', baseUrl);
        document.getElementById('bash-prod').textContent = document.getElementById('bash-prod').textContent.replace('${SHEETBOT_BASEURL}', baseUrl);
        hljs.highlightAll();

        // Sample data for each widget section
        const widgetData = {
            text: {
                columns: [
                    { name: "widget_text", widgettype: "text", minwidth: 200, minheight: 200, columnorder: 1, datatype: "TEXT" },
                    { name: "widget_text_centered", widgettype: "text-centered", minwidth: 200, minheight: 200, columnorder: 2, datatype: "TEXT" }
                ],
                rows: [
                    ["Hello World", "Centered Text"]
                ]
            },
            code: {
                columns: [
                    { name: "widget_code", widgettype: "code", minwidth: 200, minheight: 200, columnorder: 1, datatype: "TEXT" },
                    { name: "widget_json_viewer", widgettype: "json-viewer", minwidth: 200, minheight: 200, defaultDepth: 2, columnorder: 2, datatype: "TEXT" }
                ],
                rows: [
                    ["console.log('Hello!')\nconst x = 42;", '{"user":{"name":"John Doe","age":30,"email":"john@example.com","active":true},"project":{"name":"SheetBot","version":"1.0.0","features":["automation","widgets","api"],"metadata":{"created":"2024-01-15","tags":["typescript","deno","database"],"stats":{"tasks":150,"completed":120,"failed":5}}},"config":{"database":{"type":"sqlite","path":"./sheets"},"agents":{"maxConcurrent":10,"timeout":"5m"},"transitions":[{"name":"cleanup","trigger":"COMPLETED","delay":"1h"}]}}']
                ]
            },
            media: {
                columns: [
                    { name: "widget_image", widgettype: "image", minwidth: 200, minheight: 200, maxwidth: 400, maxheight: 400, columnorder: 1, datatype: "TEXT" },
                    { name: "widget_download", widgettype: "download", minwidth: 200, minheight: 200, maxwidth: 400, maxheight: 400, columnorder: 2, datatype: "TEXT" },
                    { name: "widget_hashimg", widgettype: "hashimg", minwidth: 200, minheight: 200, maxwidth: 400, maxheight: 400, columnorder: 3, datatype: "TEXT" },
                    { name: "widget_video", widgettype: "video", minwidth: 200, minheight: 200, columnorder: 4, datatype: "TEXT" },
                    { name: "widget_audio", widgettype: "audio", minwidth: 200, minheight: 200, columnorder: 5, datatype: "TEXT" }
                ],
                rows: [
                    ["logo.png", "example.txt", "abc123", "https://download.blender.org/peach/bigbuckbunny_movies/BigBuckBunny_640x360.m4v", "https://www.soundjay.com/misc/sounds/bell-ringing-05.wav"]
                ]
            },
            task: {
                columns: [
                    { name: "widget_taskstatus", widgettype: "taskstatus", minwidth: 200, minheight: 200, columnorder: 1, datatype: "INTEGER" },
                    { name: "widget_taskid", widgettype: "taskid", minwidth: 200, minheight: 200, columnorder: 2, datatype: "TEXT" },
                    { name: "widget_taskname", widgettype: "taskname", minwidth: 200, minheight: 200, columnorder: 3, datatype: "TEXT" },
                    { name: "widget_tasktype", widgettype: "tasktype", minwidth: 200, minheight: 200, columnorder: 4, datatype: "TEXT" }
                ],
                rows: [
                    [2, "abc-123-def-456", "Build Project", "deno"]
                ]
            },
            time: {
                columns: [
                    { name: "widget_timestamp", widgettype: "timestamp", minwidth: 200, minheight: 200, columnorder: 1, datatype: "INTEGER" },
                    { name: "widget_relative_timestamp", widgettype: "relative-timestamp", minwidth: 200, minheight: 200, columnorder: 2, datatype: "INTEGER" },
                    { name: "widget_progress", widgettype: "progress", minwidth: 200, minheight: 200, columnorder: 3, datatype: "INTEGER" },
                    { name: "widget_duration", widgettype: "duration", minwidth: 200, minheight: 200, columnorder: 4, datatype: "INTEGER" },
                    { name: "widget_metric", widgettype: "metric", minwidth: 200, minheight: 200, columnorder: 5, datatype: "TEXT" }
                ],
                rows: [
                    [1640995200, Math.floor(Date.now()/1000) - 3600, 75, 3661, {value: 1024, unit: 'MB', label: 'File Size'}]
                ]
            },
            rating: {
                columns: [
                    { name: "widget_rating", widgettype: "rating", minwidth: 200, minheight: 200, columnorder: 1, datatype: "REAL" },
                    { name: "widget_testresult", widgettype: "testresult", minwidth: 200, minheight: 200, columnorder: 2, datatype: "TEXT" }
                ],
                rows: [
                    [4.5, "PASS"]
                ]
            },
            schema: {
                columns: [
                    { name: "widget_jsonschema", widgettype: "jsonschema", minwidth: 200, minheight: 200, columnorder: 1, datatype: "TEXT" },
                    { name: "widget_jsonschema_validation", widgettype: "jsonschema-validation", minwidth: 200, minheight: 200, columnorder: 2, datatype: "TEXT" },
                    { name: "widget_jsonschema_explanation", widgettype: "jsonschema-explanation", minwidth: 200, minheight: 200, columnorder: 3, datatype: "TEXT" }
                ],
                rows: [
                    ['{"type":"string","maxLength":100}', '{"valid":true,"errors":[]}', '{"type":"object","required":["name"],"properties":{"name":{"type":"string"}}}']
                ]
            },
            interactive: {
                columns: [
                    { name: "widget_sheetkey", widgettype: "sheetkey", minwidth: 200, minheight: 200, columnorder: 1, datatype: "TEXT" },
                    { name: "widget_schedule_task", widgettype: "schedule-task", minwidth: 200, minheight: 200, columnorder: 2, datatype: "TEXT" },
                    { name: "widget_multi", widgettype: ["multi", "text", "code"], minwidth: 200, minheight: 200, columnorder: 3, datatype: "TEXT" },
                    { name: "widget_transitions", widgettype: "transitions", minwidth: 200, minheight: 200, columnorder: 4, datatype: "TEXT" },
                    { name: "widget_qr_code", widgettype: "qr-code", minwidth: 200, minheight: 200, columnorder: 5, datatype: "TEXT" }
                ],
                rows: [
                    ["sheet_001", "build.ts", "function build() {\n    console.log('Building project...');\n    return 'success';\n}", '[{"statuses":["COMPLETED"],"condition":{"type":"object","properties":{"data":{"type":"object","properties":{"errorCount":{"type":"number","maximum":3}}}}},"timing":{"every":"1h","immediate":false},"transitionTo":"DELETED"}]', "https://github.com/jorisvddonk/sheetbot"]
                ]
            }
        };



        // Set up each grid with its data
        const grids = [
            'text-widgets', 'code-widgets', 'media-widgets', 'task-widgets',
            'time-widgets', 'rating-widgets', 'schema-widgets', 'interactive-widgets'
        ];

        grids.forEach(gridId => {
            const element = document.getElementById(gridId);
            const dataKey = gridId.replace('-widgets', '');
            console.log(`Setting up ${gridId} with data key ${dataKey}`);
            console.log('Element found:', !!element);
            console.log('Data exists:', !!widgetData[dataKey]);

            if (element && widgetData[dataKey]) {
                const gridData = {
                    data: widgetData[dataKey].rows,
                    columns: widgetData[dataKey].columns
                };
                console.log('Grid data:', gridData);
                element.setAttribute('data', JSON.stringify(gridData));
                console.log(`Successfully set data for ${gridId}`);
            } else {
                console.error(`Failed to set up ${gridId} - element: ${!!element}, data: ${!!widgetData[dataKey]}`);
            }
        });

        // Populate source data displays immediately
        const dataMapping = {
            'text-data': 'text',
            'code-data': 'code',
            'media-data': 'media',
            'task-data': 'task',
            'time-data': 'time',
            'rating-data': 'rating',
            'schema-data': 'schema',
            'interactive-data': 'interactive'
        };

        // Test if JavaScript is running
        console.log('JavaScript is running!');
        console.log('widgetData exists:', typeof widgetData);
        console.log('widgetData keys:', widgetData ? Object.keys(widgetData) : 'N/A');

        // Simple test - put some text in the first element
        const testElement = document.getElementById('text-data');
        if (testElement) {
            testElement.innerText = 'TEST: JavaScript is working!';
            console.log('Test element found and populated');
        } else {
            console.error('Test element NOT found');
        }

        // Populate data immediately since we're at the end of body
        Object.keys(dataMapping).forEach(dataId => {
            const element = document.getElementById(dataId);
            const dataKey = dataMapping[dataId];

            if (element && widgetData[dataKey]) {
                element.textContent = JSON.stringify(widgetData[dataKey], null, 2);
                console.log(`Successfully populated ${dataId}`);
            } else {
                console.error(`Failed to populate ${dataId} - element: ${!!element}, data: ${!!widgetData[dataKey]}`);
            }
        });

        // Apply syntax highlighting to the code blocks
        hljs.highlightAll();
</script>

</html>